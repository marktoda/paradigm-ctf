// SPDX-License-Identifier: UNLICENSED

// DO NOT RELEASE SOURCE FOR THIS CHAL IT'S A REVERSING CHALLENGE.
//
// Challenge author: stong (cts), Zellic Inc.
// Challenge prepared for Paradigm CTF 2022

contract Deployer {
    constructor(bytes memory code) { assembly { return (add(code, 0x20), mload(code)) } }
}

pragma solidity 0.8.16;

/* import "Challenge.sol"; */

interface ChallengeInterface {
    function solved() external view returns (bool);
    function check(bytes memory) external;
}

contract Setup {
    Deployer public deployer;

    constructor() {
        deployer = new Deployer(hex"608060405234801561001057600080fd5b50600436106100365760003560e01c8063799320bb1461003b578063c64b3bb51461005c575b600080fd5b6000546100489060ff1681565b604051901515815260200160405180910390f35b61006f61006a366004610bdd565b610071565b005b602a811461009a5760405162461bcd60e51b815260040161009190610c4f565b60405180910390fd5b818160008181106100ad576100ad610c75565b9050013560f81c60f81b6001600160f81b031916600560fc1b1480156100fc5750818160018181106100e1576100e1610c75565b9050013560f81c60f81b6001600160f81b031916604360f81b145b801561013157508181600281811061011657610116610c75565b9050013560f81c60f81b6001600160f81b031916601560fa1b145b801561016657508181600381811061014b5761014b610c75565b9050013560f81c60f81b6001600160f81b031916602360f91b145b801561019b57508181600481811061018057610180610c75565b9050013560f81c60f81b6001600160f81b031916607b60f81b145b6101b75760405162461bcd60e51b815260040161009190610c4f565b81816101c4600182610ca1565b8181106101d3576101d3610c75565b9050013560f81c60f81b6001600160f81b031916607d60f81b146102095760405162461bcd60e51b815260040161009190610c4f565b610211610b92565b60005b60068110156102bf5760005b60068110156102ac57848482610237856006610cb4565b610242906005610cd3565b61024c9190610cd3565b81811061025b5761025b610c75565b919091013560f81c905083836006811061027757610277610c75565b6020020151826006811061028d5761028d610c75565b60ff9092166020929092020152806102a481610ce6565b915050610220565b50806102b781610ce6565b915050610214565b5060006040518060c001604052806040518060c0016040528060be60ff168152602001609a60ff16815260200160c260ff168152602001602460ff168152602001607f60ff168152602001604d60ff1681525081526020016040518060c00160405280605960ff16815260200160de60ff168152602001603b60ff168152602001606160ff168152602001600a60ff168152602001601a60ff1681525081526020016040518060c0016040528060c860ff168152602001601860ff168152602001609660ff168152602001600e60ff168152602001609460ff168152602001604d60ff1681525081526020016040518060c0016040528060e360ff168152602001606460ff168152602001608c60ff168152602001606d60ff168152602001607660ff16815260200160fe60ff1681525081526020016040518060c00160405280601660ff16815260200160d160ff168152602001604160ff168152602001608e60ff168152602001600e60ff168152602001605060ff1681525081526020016040518060c0016040528060e760ff168152602001604260ff16815260200160a460ff168152602001608760ff168152602001608e60ff168152602001606b60ff16815250815250905060006040518060c001604052806040518060c00160405280602360ff16815260200160ab60ff168152602001601e60ff168152602001604c60ff16815260200160e960ff168152602001600e60ff1681525081526020016040518060c0016040528060ef60ff168152602001605360ff16815260200160b460ff16815260200160ac60ff168152602001601860ff16815260200160b160ff1681525081526020016040518060c00160405280603c60ff16815260200160c260ff168152602001602f60ff168152602001603460ff168152602001604a60ff168152602001601860ff1681525081526020016040518060c00160405280606560ff168152602001609460ff168152602001606760ff16815260200160d360ff168152602001605960ff168152602001602960ff1681525081526020016040518060c0016040528060a060ff168152602001602760ff168152602001604a60ff168152602001607360ff16815260200160cd60ff168152602001608860ff1681525081526020016040518060c00160405280605e60ff168152602001603260ff168152602001605060ff168152602001602060ff168152602001608060ff168152602001600e60ff16815250815250905060006040518060c001604052806040518060c00160405280606260ff168152602001606260ff168152602001602d60ff168152602001605760ff168152602001608260ff168152602001602a60ff1681525081526020016040518060c0016040528060c860ff16815260200160b860ff168152602001606b60ff168152602001606660ff168152602001608b60ff168152602001601960ff1681525081526020016040518060c00160405280604960ff168152602001608b60ff168152602001603a60ff168152602001608860ff16815260200160d960ff168152602001608160ff1681525081526020016040518060c0016040528060db60ff168152602001601560ff168152602001606b60ff16815260200160cc60ff168152602001601260ff16815260200160db60ff1681525081526020016040518060c00160405280609160ff16815260200160c060ff168152602001601160ff168152602001605660ff16815260200160a660ff16815260200160d960ff1681525081526020016040518060c00160405280602860ff16815260200160f860ff168152602001602b60ff168152602001604760ff168152602001605d60ff16815260200160e260ff1681525081525090506108388361083286856108c590919063ffffffff16565b906109d4565b93506108488361083284876108c5565b93506108588361083284876108c5565b93506108688361083284876108c5565b93506108788361083284876108c5565b93506108888361083284876108c5565b93506108948482610a85565b6108b05760405162461bcd60e51b815260040161009190610c4f565b50506000805460ff1916600117905550505050565b6108cd610b92565b6108d5610b92565b60005b60068110156109ca5760005b60068110156109b75760005b60068110156109a45761095b87846006811061090e5761090e610c75565b6020020151826006811061092457610924610c75565b602002015187836006811061093b5761093b610c75565b6020020151846006811061095157610951610c75565b6020020151610b3d565b84846006811061096d5761096d610c75565b6020020151836006811061098357610983610c75565b6020020180519190911860ff1690528061099c81610ce6565b9150506108f0565b50806109af81610ce6565b9150506108e4565b50806109c281610ce6565b9150506108d8565b5090505b92915050565b6109dc610b92565b60005b6006811015610a7d5760005b6006811015610a6a57838260068110610a0657610a06610c75565b60200201518160068110610a1c57610a1c610c75565b6020020151858360068110610a3357610a33610c75565b60200201518260068110610a4957610a49610c75565b6020020180519190911860ff16905280610a6281610ce6565b9150506109eb565b5080610a7581610ce6565b9150506109df565b509192915050565b6000805b6006811015610b335760005b6006811015610b2057838260068110610ab057610ab0610c75565b60200201518160068110610ac657610ac6610c75565b602002015160ff16858360068110610ae057610ae0610c75565b60200201518260068110610af657610af6610c75565b602002015160ff1614610b0e576000925050506109ce565b80610b1881610ce6565b915050610a95565b5080610b2b81610ce6565b915050610a89565b5060019392505050565b6000805b60ff831615610b8b576001831615610b565783185b6080841615610b715760018460ff16901b601b189350610b7c565b60018460ff16901b93505b60018360ff16901c9250610b41565b9392505050565b6040518060c001604052806006905b610ba9610bbf565b815260200190600190039081610ba15790505090565b6040518060c001604052806006906020820280368337509192915050565b60008060208385031215610bf057600080fd5b823567ffffffffffffffff80821115610c0857600080fd5b818501915085601f830112610c1c57600080fd5b813581811115610c2b57600080fd5b866020828501011115610c3d57600080fd5b60209290920196919550909350505050565b6020808252600c908201526b696e76616c696420666c616760a01b604082015260600190565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b818103818111156109ce576109ce610c8b565b6000816000190483118215151615610cce57610cce610c8b565b500290565b808201808211156109ce576109ce610c8b565b600060018201610cf857610cf8610c8b565b506001019056fea26469706673582212207584d33f62811e08b955e14ce35424ba0b471119d9742094e9ed05f52c3f6e6664736f6c63430008100033");

    }
}
